# 设施－主机

可以查看集群内各个主机的配置、状态；

可以随时快速添加主机；

可以一键将某主机上的任务调度至其它机器以停服维护该主机；

可以为主机打标签来配合任务调度，或者以此划分生产、测试环境


**主机列表**

添加主机、节点概览及节点管理。

* 添加主机：添加work节点到集群，暂时不能修改节点属性。

   点击`添加主机`按钮，输入待加入的主机ip－－生成添加脚本－－按界面提示到目标主机执行操作即可。
 
   *注：* 添加主机需要检查节点到ntp服务、关闭selnux、以及docker的tcp端口设置，
   
   以centos为例:
   
        vi /lib/systemd/system/docker.service    ip修改为安装Crane 体验版ip
        
   		ExecStart=/usr/bin/dockerd  --insecure-registry=192.168.1.80:5000 -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock
      
      
     修改完成后 执行
     
        systemctl deamon－reload && systemctl restart docker。
     
     
     Ubuntu:
 
		vi /etc/default/docker , 设置

		DOCKER_OPTS="-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock"

	保存并执行命令

		service docker restart


* 节点概览：`id`、`主机名`、`角色`、`可用性`、`状态`、`标签`、`添加时间`等信息

  * id:    集群内的节点id
  * 主机名:  集群内节点主机名
  * 角色: 分为管理节点和工作节点，只有管理节点能调度server及节点角色。目前使用单管理节点。
  * 可用性: 调度开关状态、可用通过`操作`菜单维护。
    * `停止调度`: 节点资源不可用，已经发布的任务会调度到其他可用资源。
    * `暂停调度`: 该节点资源暂时不接受新任务调度，已经发布的任务不受影响。
    * `正常调度`: 节点资源完全放开。
  * 状态：分为`就绪`和`下线`；`就绪`状态指节点状态正常，`下线`状态指节点已经离开群集、资源不可用。
  * 标签：节点的label信息、配合服务发布时的资源调度时使用。
  * 添加时间： 记录节点加入集群时间
  
* 节点操作：
  
  * 连接主机：填写主机ip；点击连接，提示更新主机成功后，点击主机id，即可查询到主机详情。
     *  基本信息：Docker相关信息和主机的基本信息
     *  容器信息：主机上已有的容器统计信息
     *  网络： 主机上现有网络信息
     *  储存卷：主机上Docker的存储卷信息
     *  镜像：节点上已有的Docker镜像 
  * 编辑标签：为主机编辑标签，便于服务发布时的策略调度使用。以`key``value`形式创建。
  * 停止调度：节点资源不可用，已经发布的任务会调度到其他可用资源。
  * 暂停调度:  该节点资源暂时不接受新任务调度，已经发布的任务不受影响。
  * 恢复调度: 节点资源恢复使用完全放开。
  * 删除主机：将主机从集群中删除，需要状态为下线状态。
     
     
   



 